{% extends "layout.html" %}
{% block content %}

<div class="admin-container">

    <h2>ðŸ›  Admin Panel</h2>

    <!-- FLASH MESSAGES -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="flash-message">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- STATS -->
    <div class="stats-grid">

        <div class="card">
            <h3>Total Users</h3>
            <p class="big-number">{{ users|length }}</p>
        </div>

        <div class="card">
            <h3>Total Items</h3>
            <p class="big-number">{{ items|length }}</p>
        </div>

    </div>

    <!-- ACTION BUTTONS -->
    <div class="admin-actions">
        <a href="/export" class="btn warning">ðŸ“¥ Export Excel</a>
        <a href="/items" class="btn primary">â¬… Back to Dashboard</a>
    </div>

    <hr style="margin:30px 0;">

    <!-- USERS TABLE -->
    <h3>ðŸ‘¤ Registered Users</h3>

    <table class="admin-table">
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Role</th>
        </tr>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.role }}</td>
        </tr>
        {% endfor %}
    </table>

    <hr style="margin:30px 0;">

    <!-- ITEMS TABLE -->
    <h3>ðŸ“¦ Reported Items</h3>

    <table class="admin-table">
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Type</th>
            <th>Location</th>
            <th>Image</th>
            <th>Action</th>
        </tr>

        {% for item in items %}
        <tr>
            <td>{{ item.id }}</td>
            <td>{{ item.title }}</td>
            <td>{{ item.type }}</td>
            <td>{{ item.location }}</td>
            <td>
                {% if item.image %}
                    <img src="{{ url_for('static', filename='uploads/' + item.image) }}"
                         width="60">
                {% else %}
                    No Image
                {% endif %}
            </td>
            <td>
                <a href="/delete/{{ item.id }}" class="btn danger">
                    Delete
                </a>
            </td>
        </tr>
        {% endfor %}
    </table>

</div>

{% endblock %}
